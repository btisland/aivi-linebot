---
name: news-push-bot
description: 透過 LINE bot 指令主動抓取並推播 AIVI 科技博客最新新聞
status: backlog
created: 2025-12-09T07:34:44Z
---

# PRD: news-push-bot

## 執行摘要

news-push-bot 是一個基於 LINE bot 的新聞推播功能，讓使用者透過簡單的指令（`/aivi`）即時獲取 AIVI 科技博客（https://www.aivi.fyi/）的最新文章。此功能消除了手動瀏覽網站的需求，讓使用者能在 LINE 對話中直接接收最新的科技資訊。

**核心價值**：透過即時、便利的方式，讓使用者隨時掌握 AIVI 科技博客的最新動態，無需離開 LINE 應用程式。

## 問題陳述

### 要解決的問題
使用者想要追蹤 AIVI 科技博客的最新文章，但現有方式存在以下痛點：
- 需要主動打開瀏覽器並訪問網站
- 無法即時得知是否有新內容更新
- 在行動裝置上切換應用程式增加操作成本
- 缺乏快速、輕量級的資訊獲取方式

### 為何重要
在快節奏的資訊時代，使用者希望能以最小的摩擦成本獲取關注的內容。LINE 作為日常高頻使用的通訊工具，整合新聞推播功能可以大幅提升資訊獲取的效率和便利性。

## 使用者故事

### 主要使用者角色
**科技愛好者 - Joseph**
- 關注科技趨勢和 AI 發展
- 經常使用 LINE 進行日常溝通
- 希望快速獲取科技資訊而不被打斷工作流程

### 使用者旅程

**情境：獲取最新科技新聞**

1. **觸發點**：使用者想知道 AIVI 博客是否有新文章
2. **動作**：打開 LINE，向 bot 傳送 `/aivi` 指令
3. **系統回應**：
   - Bot 即時抓取 AIVI 網站首頁
   - 解析並提取最新的文章（最多 5 則）
   - 以結構化格式回傳標題和連結
4. **結果**：使用者在 LINE 中直接看到最新文章清單，可點擊連結閱讀

### 解決的痛點
- ✅ 無需切換應用程式或開啟瀏覽器
- ✅ 指令簡單直覺，一鍵獲取資訊
- ✅ 即時性高，隨時查詢隨時獲得最新內容
- ✅ 資訊簡潔，只顯示標題和連結，不造成資訊過載

## 需求規格

### 功能需求

#### FR-1: 指令觸發機制
- **FR-1.1**: 系統應監聽使用者在 LINE 中輸入的 `/aivi` 指令
- **FR-1.2**: 指令格式不區分大小寫（`/aivi`、`/AIVI`、`/Aivi` 均有效）
- **FR-1.3**: 指令接收後應立即觸發新聞抓取流程

#### FR-2: 網頁爬取功能
- **FR-2.1**: 系統應訪問 https://www.aivi.fyi/ 網站首頁
- **FR-2.2**: 系統應解析首頁 HTML 結構，提取文章資訊
- **FR-2.3**: 抓取內容包含：
  - 文章標題（完整標題文字）
  - 文章連結（完整 URL）
- **FR-2.4**: 系統只抓取首頁顯示的文章，不需翻頁或深度爬取

#### FR-3: 內容篩選與限制
- **FR-3.1**: 系統應返回最多 5 則最新文章
- **FR-3.2**: 若首頁文章少於 5 則，則返回所有可用文章
- **FR-3.3**: 文章應按照網站原始順序排列（通常為發布時間倒序）

#### FR-4: 訊息推播
- **FR-4.1**: 系統應將抓取的新聞以 LINE 訊息形式傳送給觸發指令的使用者
- **FR-4.2**: 訊息格式應清晰易讀，每則新聞包含：
  - 標題文字
  - 可點擊的連結
- **FR-4.3**: 多則新聞應以清單或編號格式呈現

#### FR-5: 錯誤處理
- **FR-5.1**: 若網站無法訪問，應回傳友善的錯誤訊息（例如：「無法連線到 AIVI 網站，請稍後再試」）
- **FR-5.2**: 若網站結構改變導致解析失敗，應回傳錯誤提示
- **FR-5.3**: 若未找到任何文章，應回傳「目前沒有找到新文章」

### 非功能需求

#### NFR-1: 效能
- **NFR-1.1**: 從接收 `/aivi` 指令到回傳結果，總時間應在 10 秒內
- **NFR-1.2**: 網頁抓取應設定合理的 timeout（建議 5 秒）
- **NFR-1.3**: 系統應能處理並發請求（雖然目前只有單一使用者）

#### NFR-2: 可靠性
- **NFR-2.1**: 系統應處理網路不穩定的情況
- **NFR-2.2**: 爬取失敗不應導致 bot 崩潰
- **NFR-2.3**: 應記錄錯誤日誌以便除錯

#### NFR-3: 可維護性
- **NFR-3.1**: 網頁解析邏輯應模組化，便於因應網站結構變更進行調整
- **NFR-3.2**: 程式碼應包含清晰的註解（繁體中文）
- **NFR-3.3**: 爬取邏輯與 LINE bot 邏輯應分離，便於測試

#### NFR-4: 相容性
- **NFR-4.1**: 應與現有 LINE bot 基礎設施整合
- **NFR-4.2**: 不應影響 bot 的其他現有功能

#### NFR-5: 合規性
- **NFR-5.1**: 網頁抓取應遵守網站的 robots.txt 規範
- **NFR-5.2**: 請求頻率應合理，避免對目標網站造成負擔
- **NFR-5.3**: User-Agent 應明確識別為 bot

## 成功指標

### 主要指標
1. **功能完整性**
   - `/aivi` 指令正確觸發新聞抓取
   - 成功返回最多 5 則新聞
   - 標題和連結格式正確且可點擊

2. **回應時間**
   - 95% 的請求在 10 秒內完成
   - 平均回應時間 < 5 秒

3. **可靠性**
   - 成功率 > 95%（排除目標網站故障）
   - 錯誤情況下能正確回傳錯誤訊息

4. **使用者滿意度**
   - 使用者（Joseph）回報功能符合需求
   - 無重大 bug 或使用問題

### 驗收標準

**測試場景 1：正常情況**
- Given: AIVI 網站正常運作且有文章
- When: 使用者輸入 `/aivi`
- Then:
  - Bot 在 10 秒內回覆
  - 回覆包含 1-5 則新聞
  - 每則新聞有標題和連結
  - 連結可正常開啟

**測試場景 2：網站無法訪問**
- Given: AIVI 網站無法連線
- When: 使用者輸入 `/aivi`
- Then:
  - Bot 回覆錯誤訊息
  - 訊息內容友善且易懂
  - Bot 不會崩潰

**測試場景 3：網站無文章**
- Given: AIVI 網站可訪問但首頁無文章
- When: 使用者輸入 `/aivi`
- Then:
  - Bot 回覆「目前沒有找到新文章」或類似訊息

**測試場景 4：指令格式變化**
- Given: 使用者輸入不同大小寫的指令
- When: 輸入 `/AIVI` 或 `/Aivi`
- Then: 功能正常執行

## 限制與假設

### 技術限制
- **L-1**: 依賴目標網站的 HTML 結構穩定性
- **L-2**: 網站若有反爬蟲機制可能影響功能
- **L-3**: 無法處理需要 JavaScript 渲染的動態內容（除非使用無頭瀏覽器）

### 時程限制
- **L-4**: 此為 MVP 版本，專注於核心功能
- **L-5**: 暫不考慮複雜的錯誤恢復機制

### 資源限制
- **L-6**: 僅支援單一新聞來源（AIVI）
- **L-7**: 目前只有一位使用者，暫不考慮擴展性

### 假設
- **A-1**: AIVI 網站的 HTML 結構相對穩定
- **A-2**: 網站允許自動化抓取（符合 robots.txt）
- **A-3**: LINE bot 基礎設施已建置完成
- **A-4**: 開發環境能正常訪問目標網站

## 範圍外項目

明確**不包含**在此版本的功能：

### 個人化功能
- ❌ 使用者自訂推播時間
- ❌ 訂閱/取消訂閱機制
- ❌ 主題或分類篩選
- ❌ 多使用者支援

### 進階內容處理
- ❌ 文章內容摘要或全文抓取
- ❌ 自然語言處理或關鍵字提取
- ❌ 圖片抓取與顯示
- ❌ 內容翻譯

### 自動化推播
- ❌ 定時自動檢查新文章
- ❌ 新文章發布時主動推播
- ❌ 推播排程設定

### 互動功能
- ❌ 文章收藏或稍後閱讀
- ❌ 按讚/評論功能
- ❌ 分享給其他聊天室

### 多來源支援
- ❌ 支援其他新聞網站
- ❌ RSS 訂閱整合
- ❌ 多來源聚合

### 資料持久化
- ❌ 歷史記錄儲存
- ❌ 已讀/未讀追蹤
- ❌ 使用者偏好儲存

## 相依性

### 外部相依
- **D-1**: LINE Messaging API - bot 訊息傳送功能
- **D-2**: AIVI 網站可用性 - 新聞來源
- **D-3**: 網路連線 - 爬取網頁需要穩定網路

### 技術相依
- **D-4**: Python 網頁爬取套件（建議 requests + BeautifulSoup4 或 httpx + selectolax）
- **D-5**: LINE bot SDK for Python（如 line-bot-sdk）
- **D-6**: 現有 LINE bot webhook 處理機制

### 內部相依
- **D-7**: LINE bot 基礎框架已部署並運作
- **D-8**: Webhook 接收與訊息路由機制
- **D-9**: 環境變數設定（LINE Channel Token 等）

### 資料相依
- **D-10**: AIVI 網站 HTML 結構（需事先分析）
- **D-11**: LINE bot 訊息格式規範

## 實作考量

### 技術方案建議

#### 網頁爬取方案
**建議**：使用 `httpx` + `selectolax`
- 優點：輕量、快速、效能佳
- 適合：靜態 HTML 解析
- 備案：若網站需要 JavaScript 渲染，改用 `playwright`

#### 訊息格式設計
建議使用 LINE Flex Message 或簡單文字格式：
```
📰 AIVI 最新文章

1. 文章標題一
   🔗 https://www.aivi.fyi/article-1

2. 文章標題二
   🔗 https://www.aivi.fyi/article-2
```

#### 錯誤處理策略
- 網路錯誤：重試 2 次，間隔 1 秒
- 解析錯誤：記錄完整 HTML 以便除錯
- Timeout：設定 5 秒 timeout，超時即回報錯誤

### 程式架構建議

```
src/
├── handlers/
│   └── aivi_command_handler.py  # 處理 /aivi 指令
├── scrapers/
│   └── aivi_scraper.py          # AIVI 網站爬蟲邏輯
├── formatters/
│   └── message_formatter.py     # LINE 訊息格式化
└── utils/
    └── error_handler.py         # 錯誤處理工具
```

### 測試策略
1. **單元測試**：爬蟲邏輯、訊息格式化
2. **整合測試**：指令處理流程
3. **手動測試**：實際在 LINE 中測試各種情境

## 後續發展可能性

雖然不在當前範圍內，但未來可考慮：

1. **自動推播**：定時檢查並主動推播新文章
2. **多來源支援**：整合更多科技博客
3. **個人化**：使用者自訂關注主題
4. **智慧摘要**：使用 AI 產生文章摘要
5. **互動增強**：收藏、分享、評論功能

## 實作時程建議

**Phase 1: 基礎爬蟲（1-2 天）**
- 實作 AIVI 網站爬蟲
- 測試 HTML 解析邏輯

**Phase 2: LINE bot 整合（1 天）**
- 實作 `/aivi` 指令處理
- 整合爬蟲與 bot

**Phase 3: 測試與優化（1 天）**
- 各種情境測試
- 錯誤處理完善
- 效能優化

**總計：3-4 天完成 MVP**

## 附錄

### 參考資源
- AIVI 網站：https://www.aivi.fyi/
- LINE Messaging API 文件：https://developers.line.biz/
- Python LINE bot SDK：https://github.com/line/line-bot-sdk-python

### 相關決策記錄
- **DR-1**: 選擇指令觸發而非自動推播，因為當前只有單一使用者，按需查詢更合適
- **DR-2**: 限制最多 5 則新聞，避免訊息過長影響閱讀體驗
- **DR-3**: 只抓取標題和連結，不做內容摘要，保持簡潔高效
